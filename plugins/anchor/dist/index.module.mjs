import*as e from"jodit";var t=e.Jodit||e;class n{init(e){this.jodit=e,e.options.controls.anchor={name:"anchor",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">\x3c!--!Font Awesome Free v7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--\x3e<path d="M160 96C160 78.3 145.7 64 128 64C110.3 64 96 78.3 96 96L96 544C96 561.7 110.3 576 128 576C145.7 576 160 561.7 160 544L160 422.4L222.7 403.6C264.6 391 309.8 394.9 348.9 414.5C391.6 435.9 441.4 438.5 486.1 421.7L523.2 407.8C535.7 403.1 544 391.2 544 377.8L544 130.1C544 107.1 519.8 92.1 499.2 102.4L487.4 108.3C442.5 130.8 389.6 130.8 344.6 108.3C308.2 90.1 266.3 86.5 227.4 98.2L160 118.4L160 96z"/></svg>\n',tooltip:e.i18n("anchorSetAnchor"),popup:this.popup.bind(this),isActive:this.isActive.bind(this)},this.afterEnterFunc=this.afterEnter.bind(this),e.events.on("afterEnter",this.afterEnterFunc)}destruct(){this.jodit.events.off("afterEnter",this.afterEnterFunc)}popup(e,n,i){const{UIForm:o,UIInput:r,Button:s}=t.modules,c=new o(this.jodit),a=new r(this.jodit,{name:"id",label:"anchorAnchorID"}),d=new s(this.jodit,"ok","anchorSet","primary");c.append(a),c.append(d);const h=this.currentElement();return h&&h.id&&(a.value=h.id),e.selection.save(),d.onAction(()=>{if(h){const t=a.value.trim();t?h.setAttribute("id",t):h.removeAttribute("id"),e.synchronizeValues()}i()}),a.container.addEventListener("keydown",e=>{"Enter"===e.key&&(d.button.click(),e.preventDefault())}),c}isActive(e){const t=this.currentElement();return t&&t.hasAttribute("id")}afterEnter(e){let t=this.jodit.selection.current();if(!t)return;1!==t.nodeType&&(t=t.parentElement);const n=t.previousElementSibling;n&&t.hasAttribute("id")&&n.hasAttribute("id")&&t.id===n.id&&(1===n.childNodes.length&&"BR"==n.childNodes[0].tagName?n.removeAttribute("id"):t.removeAttribute("id"))}currentElement(){const e=this.findCurrentElement();return e===this.jodit.editor?null:e}findCurrentElement(){const e=this.jodit.selection.current();return e?e.nodeType===Node.TEXT_NODE?"\ufeff"===e.textContent&&e.previousElementSibling?.matches("jodit-media")?e.previousElementSibling.querySelector("video, audio"):e.parentElement:e.matches("jodit")?e.querySelector("iframe"):e.matches("jodit-media")?e.querySelector("video, audio"):e.matches('span[id^="jodit-selection_marker"]')?e.parentNode:e:null}}var i={en:{anchorSetAnchor:"Set anchor ID",anchorAnchorID:"Anchor ID",anchorSet:"Set"},ja:{anchorSetAnchor:"アンカーIDを設定",anchorAnchorID:"アンカーID",anchorSet:"設定"}};Object.keys(i).forEach(e=>{t.lang[e]={...t.lang[e],...i[e]}}),t.plugins.add("anchor",n);export{n as default};
//# sourceMappingURL=index.module.mjs.map
