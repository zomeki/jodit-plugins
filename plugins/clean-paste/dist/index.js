"use strict";var e=require("jodit");const t=e.Jodit.constants.globalDocument,s=e.Jodit.modules.Dom,{toArray:o,trim:n}=e.Jodit.modules.Helpers;function r(e){-1!==e.indexOf("<html ")&&(e=(e=e.substring(e.indexOf("<html "),e.length)).substring(0,e.lastIndexOf("</html>")+7));let r="";try{const n=t.createElement("div");n.innerHTML=e;const i=[];n.firstChild&&s.each(n,e=>{if(e)switch(e.nodeType){case Node.ELEMENT_NODE:switch(e.nodeName){case"STYLE":case"LINK":case"META":i.push(e);break;case"W:SDT":case"W:SDTPR":case"FONT":s.unwrap(e);break;default:o(e.attributes).forEach(t=>{-1===["src","href","rel","content","colspan","rowspan"].indexOf(t.name.toLowerCase())&&e.removeAttribute(t.name)})}break;case Node.TEXT_NODE:break;default:i.push(e)}}),s.safeRemove.apply(null,i),r=n.innerHTML}catch(e){}return r&&(e=r),(e=e.split(/(\n)/).filter(n).join("\n")).replace(/<(\/)?(html|colgroup|col|o:p)[^>]*>/g,"").replace(/<!--[^>]*>/g,"")}const i=e.Jodit.plugins.get("paste-from-word");if(i){const e=i.prototype.insertFromWordByType;i.prototype.insertFromWordByType=function(t,s,o,n){"insert_by_clean_paste"===o?this.j.selection.insertHTML(r(s)):e.apply(this,[t,s,o,n])}}class a{init(e){this.jodit=e,this.jodit.events.on("onCustomPasteHTMLOption",(e,t)=>{if("insert_by_clean_paste"===e)return r(t)})}}e.Jodit.plugins.add("paste-patch",a),module.exports=a;
//# sourceMappingURL=index.js.map
