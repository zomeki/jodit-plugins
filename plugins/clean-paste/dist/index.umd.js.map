{"version":3,"file":"index.umd.js","sources":["../src/clean.js","../src/paste-from-word-patch.js","../src/plugin.js","../src/index.js"],"sourcesContent":["import { Jodit } from 'jodit';\n\nconst globalDocument = Jodit.constants.globalDocument;\nconst Dom = Jodit.modules.Dom;\nconst { toArray, trim } = Jodit.modules.Helpers;\n\n// patch for https://github.com/xdan/jodit/blob/4.7.9/src/core/helpers/html/clean-from-word.ts\nexport default function(html) {\n  if (html.indexOf('<html ') !== -1) {\n    html = html.substring(html.indexOf('<html '), html.length);\n    html = html.substring(\n      0,\n      html.lastIndexOf('</html>') + '</html>'.length\n    );\n  }\n\n  let convertedString = '';\n\n  try {\n    const div = globalDocument.createElement('div');\n    div.innerHTML = html;\n\n    const marks = [];\n\n    if (div.firstChild) {\n      Dom.each(div, node => {\n        if (!node) {\n          return;\n        }\n        switch (node.nodeType) {\n          case Node.ELEMENT_NODE:\n            switch (node.nodeName) {\n              case 'STYLE':\n              case 'LINK':\n              case 'META':\n                marks.push(node);\n                break;\n\n              case 'W:SDT':\n              case 'W:SDTPR':\n              case 'FONT':\n                Dom.unwrap(node);\n                break;\n\n              default:\n                toArray(node.attributes).forEach(\n                  (attr) => {\n                    if (\n                      [\n                        'src',\n                        'href',\n                        'rel',\n                        'content',\n                        // patch start\n                        'colspan',\n                        'rowspan'\n                        // patch end\n                      ].indexOf(\n                        attr.name.toLowerCase()\n                      ) === -1\n                    ) {\n                      node.removeAttribute(\n                        attr.name\n                      );\n                    }\n                  }\n                );\n            }\n            break;\n          case Node.TEXT_NODE:\n            break;\n          default:\n            marks.push(node);\n        }\n      });\n    }\n\n    Dom.safeRemove.apply(null, marks);\n\n    convertedString = div.innerHTML;\n  } catch (e) {}\n\n  if (convertedString) {\n    html = convertedString;\n  }\n\n  html = html.split(/(\\n)/).filter(trim).join('\\n');\n\n  return html\n    .replace(/<(\\/)?(html|colgroup|col|o:p)[^>]*>/g, '')\n    .replace(/<!--[^>]*>/g, '');\n}\n","import { Jodit } from 'jodit';\nimport clean from './clean';\n\nconst plugin = Jodit.plugins.get('paste-from-word');\n\nif (plugin) {\n  const original = plugin.prototype.insertFromWordByType;\n  plugin.prototype.insertFromWordByType = function(e, html, insertType, texts) {\n    if (insertType === 'insert_by_clean_paste') {\n      this.j.selection.insertHTML(clean(html));\n    } else {\n      original.apply(this, [e, html, insertType, texts]);\n    }\n  };\n}\n","import clean from './clean';\nimport './paste-from-word-patch';\n\nexport default class {\n  init(jodit) {\n    this.jodit = jodit;\n\n    this.jodit.events.on('onCustomPasteHTMLOption', (action, html) => {\n      if (action === 'insert_by_clean_paste') {\n        return clean(html);\n      }\n    });\n  }\n}\n","import { Jodit } from 'jodit';\nimport Plugin from './plugin.js';\n\nJodit.plugins.add('paste-patch', Plugin);\n\nexport default Plugin;\n"],"names":["globalDocument","Jodit","constants","Dom","modules","toArray","trim","Helpers","clean","html","indexOf","substring","length","lastIndexOf","convertedString","div","createElement","innerHTML","marks","firstChild","each","node","nodeType","Node","ELEMENT_NODE","nodeName","push","unwrap","attributes","forEach","attr","name","toLowerCase","removeAttribute","TEXT_NODE","safeRemove","apply","e","split","filter","join","replace","plugin","plugins","get","original","prototype","insertFromWordByType","insertType","texts","this","j","selection","insertHTML","Plugin","init","jodit","events","on","action","add"],"mappings":"0RAEA,MAAMA,EAAiBC,EAAAA,MAAMC,UAAUF,eACjCG,EAAMF,EAAAA,MAAMG,QAAQD,KACpBE,QAAEA,EAAOC,KAAEA,GAASL,EAAKA,MAACG,QAAQG,QAGzB,SAAAC,EAASC,IACU,IAA5BA,EAAKC,QAAQ,YAEfD,GADAA,EAAOA,EAAKE,UAAUF,EAAKC,QAAQ,UAAWD,EAAKG,SACvCD,UACV,EACAF,EAAKI,YAAY,WAAa,IAIlC,IAAIC,EAAkB,GAEtB,IACE,MAAMC,EAAMf,EAAegB,cAAc,OACzCD,EAAIE,UAAYR,EAEhB,MAAMS,EAAQ,GAEVH,EAAII,YACNhB,EAAIiB,KAAKL,EAAKM,IACZ,GAAKA,EAGL,OAAQA,EAAKC,UACX,KAAKC,KAAKC,aACR,OAAQH,EAAKI,UACX,IAAK,QACL,IAAK,OACL,IAAK,OACHP,EAAMQ,KAAKL,GACX,MAEF,IAAK,QACL,IAAK,UACL,IAAK,OACHlB,EAAIwB,OAAON,GACX,MAEF,QACEhB,EAAQgB,EAAKO,YAAYC,QACtBC,KAaU,IAXP,CACE,MACA,OACA,MACA,UAEA,UACA,WAEApB,QACAoB,EAAKC,KAAKC,gBAGZX,EAAKY,gBACHH,EAAKC,QAMjB,MACF,KAAKR,KAAKW,UACR,MACF,QACEhB,EAAMQ,KAAKL,MAKnBlB,EAAIgC,WAAWC,MAAM,KAAMlB,GAE3BJ,EAAkBC,EAAIE,SACxB,CAAE,MAAOoB,GAAI,CAQb,OANIvB,IACFL,EAAOK,IAGTL,EAAOA,EAAK6B,MAAM,QAAQC,OAAOjC,GAAMkC,KAAK,OAGzCC,QAAQ,uCAAwC,IAChDA,QAAQ,cAAe,GAC5B,CCxFA,MAAMC,EAASzC,EAAAA,MAAM0C,QAAQC,IAAI,mBAEjC,GAAIF,EAAQ,CACV,MAAMG,EAAWH,EAAOI,UAAUC,qBAClCL,EAAOI,UAAUC,qBAAuB,SAASV,EAAG5B,EAAMuC,EAAYC,GACjD,0BAAfD,EACFE,KAAKC,EAAEC,UAAUC,WAAW7C,EAAMC,IAElCoC,EAAST,MAAMc,KAAM,CAACb,EAAG5B,EAAMuC,EAAYC,IAGjD,CCXe,MAAAK,EACbC,IAAAA,CAAKC,GACHN,KAAKM,MAAQA,EAEbN,KAAKM,MAAMC,OAAOC,GAAG,0BAA2B,CAACC,EAAQlD,KACvD,GAAe,0BAAXkD,EACF,OAAOnD,EAAMC,IAGnB,SCTG+C,EAAAvD,MAAC0C,QAAQiB,IAAI,cAAeN"}