{"version":3,"file":"index.module.mjs","sources":["../src/plugin.js","../src/index.js"],"sourcesContent":["export default class {\n  init(jodit) {\n    this.jodit = jodit;\n    this.sanitizeFunc = this.sanitize.bind(this);\n    this.sanitizePasteFunc = this.sanitizePaste.bind(this);\n\n    jodit.events.on('change', this.sanitizeFunc);\n    jodit.events.on('processPaste', this.sanitizePasteFunc);\n  }\n\n  destruct() {\n    this.jodit.events.off('change', this.sanitizeFunc);\n    this.jodit.events.off('processPaste', this.sanitizePasteFunc);\n  }\n\n  sanitize() {\n    const changed = this.removeUnsafeAttributes(this.jodit.editor);\n    if (changed) this.jodit.synchronizeValues();\n  }\n\n  sanitizePaste(event, html, type) {\n    const wrapper = document.createElement('div');\n    wrapper.innerHTML = html;\n    const changed = this.removeUnsafeAttributes(wrapper);\n    if (changed) return wrapper.innerHTML;\n    return html;\n  }\n\n  removeUnsafeAttributes(rootElem) {\n    let changed = false;\n    rootElem.querySelectorAll('*').forEach(elem => {\n      [...elem.attributes].forEach(attr => {\n        if (attr.name.match(/^(href|src|action)$/i) && attr.value.match(/^javascript:/i)) {\n          elem.removeAttribute(attr.name);\n          changed = true;\n        }\n        if (attr.name.match(/^on/i)) {\n          elem.removeAttribute(attr.name);\n          changed = true;\n        }\n      });\n    });\n    return changed;\n  }\n}\n","import { Jodit } from 'jodit';\nimport Plugin from './plugin.js';\n\nJodit.plugins.add('html-sanitizer', Plugin);\n\nexport default Plugin;\n"],"names":["Plugin","init","jodit","this","sanitizeFunc","sanitize","bind","sanitizePasteFunc","sanitizePaste","events","on","destruct","off","removeUnsafeAttributes","editor","synchronizeValues","event","html","type","wrapper","document","createElement","innerHTML","rootElem","changed","querySelectorAll","forEach","elem","attributes","attr","name","match","value","removeAttribute","Jodit","plugins","add"],"mappings":"8BAAe,MAAAA,EACbC,IAAAA,CAAKC,GACHC,KAAKD,MAAQA,EACbC,KAAKC,aAAeD,KAAKE,SAASC,KAAKH,MACvCA,KAAKI,kBAAoBJ,KAAKK,cAAcF,KAAKH,MAEjDD,EAAMO,OAAOC,GAAG,SAAUP,KAAKC,cAC/BF,EAAMO,OAAOC,GAAG,eAAgBP,KAAKI,kBACvC,CAEAI,QAAAA,GACER,KAAKD,MAAMO,OAAOG,IAAI,SAAUT,KAAKC,cACrCD,KAAKD,MAAMO,OAAOG,IAAI,eAAgBT,KAAKI,kBAC7C,CAEAF,QAAAA,GACkBF,KAAKU,uBAAuBV,KAAKD,MAAMY,SAC1CX,KAAKD,MAAMa,mBAC1B,CAEAP,aAAAA,CAAcQ,EAAOC,EAAMC,GACzB,MAAMC,EAAUC,SAASC,cAAc,OACvCF,EAAQG,UAAYL,EAEpB,OADgBd,KAAKU,uBAAuBM,GACxBA,EAAQG,UACrBL,CACT,CAEAJ,sBAAAA,CAAuBU,GACrB,IAAIC,GAAU,EAad,OAZAD,EAASE,iBAAiB,KAAKC,QAAQC,IACrC,IAAIA,EAAKC,YAAYF,QAAQG,IACvBA,EAAKC,KAAKC,MAAM,yBAA2BF,EAAKG,MAAMD,MAAM,mBAC9DJ,EAAKM,gBAAgBJ,EAAKC,MAC1BN,GAAU,GAERK,EAAKC,KAAKC,MAAM,UAClBJ,EAAKM,gBAAgBJ,EAAKC,MAC1BN,GAAU,OAITA,CACT,ECxCFU,EAAMC,QAAQC,IAAI,iBAAkBpC"}