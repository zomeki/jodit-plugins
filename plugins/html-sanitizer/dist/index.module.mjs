import{Jodit as t}from"jodit";class e{init(t){this.jodit=t,this.sanitizeFunc=this.sanitize.bind(this),this.sanitizePasteFunc=this.sanitizePaste.bind(this),t.events.on("change",this.sanitizeFunc),t.events.on("processPaste",this.sanitizePasteFunc)}destruct(){this.jodit.events.off("change",this.sanitizeFunc),this.jodit.events.off("processPaste",this.sanitizePasteFunc)}sanitize(){this.removeUnsafeAttributes(this.jodit.editor)&&this.jodit.synchronizeValues()}sanitizePaste(t,e,i){const s=document.createElement("div");s.innerHTML=e;return this.removeUnsafeAttributes(s)?s.innerHTML:e}removeUnsafeAttributes(t){let e=!1;return t.querySelectorAll("*").forEach(t=>{[...t.attributes].forEach(i=>{i.name.match(/^(href|src|action)$/i)&&i.value.match(/^javascript:/i)&&(t.removeAttribute(i.name),e=!0),i.name.match(/^on/i)&&(t.removeAttribute(i.name),e=!0)})}),e}}t.plugins.add("html-sanitizer",e);export{e as default};
//# sourceMappingURL=index.module.mjs.map
